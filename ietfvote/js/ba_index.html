<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://raw.github.com/documentcloud/underscore/master/underscore.js"></script>
<script src="http://code.highcharts.com/stock/highstock.js"></script>

<script src="ba_dummy_data.js"></script>
<script src="ba_rate.js"></script>

</head>
<body>

<div id="container" style="height: 500px; min-width: 500px"></div>

<script>
     $(function() {
     var simulator = new data_simulator();
     var initial_data = [];
     var t = (new Date().getTime() / 1000) * 1000 -100000;
     var ba;

     for (var i=0; i<100; i++) {
	initial_data.push([t, 2.5])
        t+=1000;			    
     }
			  
     function poll() {
       console.log("Poll called");
       d = simulator.generate_next_second();
			  //ba.update_plot(d);
       setTimeout(function() {
			  ba.update_plot(d);
			  setTimeout(poll, 100);
			  },10);
	}
			  
     ba = new ba_rate("container", initial_data, function() {poll_appspot(ba);});
     ba.start_plot();

}
);
</script>
</body>
