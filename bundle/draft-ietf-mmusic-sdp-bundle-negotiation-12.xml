<?xml version="1.0" encoding="iso-8859-1"?>
<!-- comment -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd"[]>
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc sortrefs="no" ?>
<rfc ipr="trust200902" category="std" docName="draft-ietf-mmusic-sdp-bundle-negotiation-11.txt" updates="3264" submissionType="IETF" xml:lang="en">
<front>
    <title abbrev="Bundled media">
		Negotiating Media Multiplexing Using the Session Description Protocol (SDP)
	</title>
    <author initials="C.H." surname="Holmberg" fullname="Christer Holmberg">
		<organization>Ericsson</organization>
		<address>
			<postal>
				<street>Hirsalantie 11</street>
				<code>02420</code>
				<city>Jorvas</city>
				<country>Finland</country>
			</postal>
			<email>christer.holmberg@ericsson.com</email>
		</address>
    </author>

	<author fullname="Harald Tveit Alvestrand" surname="Alvestrand" initials="H. T.">
		<organization>Google</organization>
		<address>
			<postal>
				<street>Kungsbron 2</street>
				<city>Stockholm</city>          
				<code>11122</code>
				<country>Sweden</country>
			</postal>
			<email>harald@alvestrand.no</email>
		</address>
    </author>

	<author fullname="Cullen Jennings" initials="C." surname="Jennings">
		<organization>Cisco</organization>
		<address>
			<postal>
				<street>400 3rd Avenue SW, Suite 350</street>
				<city>Calgary</city>
				<region>AB</region>
				<code>T2P 4H2</code>
				<country>Canada</country>
			</postal>
			<email>fluffy@iii.ca</email>
      </address>
    </author>
	
    <date year="2014" />
    <area>Transport</area>
    <workgroup>MMUSIC Working Group</workgroup>
    <keyword>RTP</keyword>
    <keyword>SDP</keyword>
	<keyword>Bundle</keyword>
    <keyword>Multiplexing</keyword>
    <keyword>RTCWEB</keyword>
	<keyword>CLUE</keyword>
	<keyword>RTCWEB</keyword>
	<keyword>MMUSIC</keyword>
	<keyword>AVT</keyword>
    <keyword>WEB</keyword>
    <keyword>Browser</keyword>

    <abstract>
		<t>
			This specification defines a new SDP Grouping Framework
			extension, 'BUNDLE'. The extension can be used with the
			Session Description Protocol (SDP) Offer/Answer
			mechanism to negotiate the usage of a single 5-tuple for
			sending and receiving media associated with multiple SDP
			media descriptions ("m="). This is referred to as
			bundled media.
		</t>
		<t>
			Both endpoints can negotiate the use of bundle and to
			support that negotiations, this specification defines a
			new SDP attribute, 'bundle-only', which can be used to
			request that specific media is only used if bundled.
			This specification also updates sections 5.1, 8.1 and
			8.2 of RFC 3264 to allows an answerer to assign a
			non-zero port value to an "m=" line in an SDP answer,
			even if the "m=" line in the associated SDP offer
			contained a zero port value.
		</t>
		<t>
			There are multiple ways to correlate the bundled RTP
			packets with the appropriate media descriptions. This
			specification defines a new RTP SDES item and a new RTP
			header extension that provides an additional way to do
			this correlation by using them to carry a value that
			associates the RTP/RTCP packets with a specific media
			description.
		</t>
    </abstract>
</front>

<middle>
    <section title="Introduction" toc="default">
		<t>
			This specification defines a way to use a single 5-tuple for sending and receiving media 
			associated with multiple SDP media descriptions ("m=" lines) . This 
			allows the usage of a single set of Interactive Connectivity Establishment 
			(ICE) <xref format="default" pageno="false" target="RFC5245"/> candidates for multiple 
			media descriptions. 
			This specification defines a new SDP Grouping Framework <xref format="default" pageno="false" 
			target="RFC5888"/> extension called 'BUNDLE'. The extension can be used with the Session Description 
			Protocol (SDP) Offer/Answer mechanism <xref format="default" pageno="false" target="RFC3264"/> 
			to negotiate the usage of a single 5-tuple for sending and receiving media associated with 
			multiple SDP media descriptions ("m="). This is referred
                        to as bundled media.
		</t>
		<t>
			The offerer and answerer <xref format="default" pageno="false" target="RFC3264"/> use
			the BUNDLE extension to negotiate the 5-tuples (BUNDLE addresses), one for the offerer (offerer BUNDLE
			address) and one for the answerer (answerer BUNDLE address) to be used for the bundled 
			media associated with a BUNDLE group. 
			Once the offerer and the answerer have negotiated a BUNDLE group, they assign their respective 
			BUNDLE address to each "m=" line in the BUNDLE group. The BUNDLE address is used to send and 
			receive all media associated with the BUNDLE group.
                        This specification 
			also defines a new SDP attribute, 'bundle-only', which can be used to request that specific media 
			is only used if bundled. 
		</t>
		<t>
		        As defined in RFC 4566 <xref format="default" pageno="false" target="RFC4566"/>, the 
			semantics of assigning the same port value to multiple "m=" lines are undefined, and there is no 
			grouping defined by such means. Instead, an explicit grouping mechanism needs to be used to 
			express the intended semantics. This specification provides such an extension.
			This specification also updates sections 5.1, 8.1 and 8.2 of RFC 3264 <xref format="default" pageno="false" 
			target="RFC3264"/>. The update allows an answerer to assign a non-zero port value to an "m=" line in an 
			SDP answer, even if the "m=" line in the associated SDP offer contained a zero port value.
		</t>
		<t>
			This specification also defines a new RTP SDES item and
                        a new RTP header extension that
			can be used to carry a value that associates RTP/RTCP packets with a specific media
			description. This can be used to correlate a RTP packet
                        with the correct media. 
		</t>
		<t>
			SDP bodies can contain multiple BUNDLE groups. A given BUNDLE address MUST only be associated
			with a single BUNDLE group.
			The procedures in this specification apply independently to a given BUNDLE group.
			All Real-time Transport Protocol (RTP) <xref format="default" 
			pageno="false" target="RFC3550"/> based media flows 
			associated with a single BUNDLE group belong to a single RTP session 
			<xref format="default" pageno="false" target="RFC3550"/>.
		</t>
		<t>
			The BUNDLE extension is backward compatible. Endpoints that do not support the extension
			are expected to generate offers and answers without an SDP 'group:BUNDLE' attribute, and
			are expected to assign a unique address to each "m=" line within an offer and answer, according 
			to the procedures in <xref format="default" pageno="false" target="RFC4566"/> and 
			<xref format="default" pageno="false" target="RFC3264"/>
		</t>
    </section>

	
    <section title="Terminology" toc="default">
		<t>
			5-tuple: A collection of the following values: source address, source port, 
			destination address, destination port, and protocol.
		</t>
		<t>
			Unique address: An IP address and IP port combination that is assigned to 
			only one "m=" line in an offer or answer.
		</t>
		<t>
			Shared address: An IP address and IP port combination that is assigned to
			multiple "m=" lines within an offer or answer.
		</t>
		<t>
			Offerer suggested BUNDLE mid: The first mid value in a given 
			SDP 'group:BUNDLE' attribute mid list in an offer.
		</t>
		<t>
			Answerer selected BUNDLE mid: The first mid value in a given
			SDP 'group:BUNDLE' attribute mid list in an answer.
		</t>
		<t>
			Offerer BUNDLE address: Within a given BUNDLE group, an IP address and IP 
			port combination used by an offerer to receive all media associated 
			with each "m=" line within the BUNDLE group.
		</t>
		<t>
			Answerer BUNDLE address: Within a given BUNDLE group, an IP address and IP 
			port combination used by an answerer to receive all media associated 
			with each "m=" line within the BUNDLE group.
		</t>
		<t>
			BUNDLE group: A set of "m=" lines, created using an SDP Offer/Answer
			exchange, for which each endpoint uses a single 5-tuple to send and 
			receive media. Each endpoint uses its BUNDLE address,
			associated with the BUNDLE group, to send and receive the media.
		</t>
		<t>
			Bundled "m=" line: An "m=" line, whose SDP 'mid' attribute value
			is placed in a SDP 'group:BUNDLE' attribute mid value list in an 
			offer or answer.
		</t>
		<t>
			Bundle-only "m=" line: A bundled "m=" line with an associated 
			SDP 'bundle-only' attribute.
		</t>
		<t>
			Bundled media: All media associated with a given BUNDLE group.
		</t>
		<t>
			Initial offer: The first offer, within an SDP session, in which
			the offerer indicates that it wants to create a given BUNDLE group.
		</t>
		<t>
			Subsequent offer: An offer which contains a BUNDLE group that 
			has been created as part of a previous SDP Offer/Answer exchange.
		</t>
	</section>

	
    <section title="Conventions" toc="default">
		<t>
			The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
			"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
			document are to be interpreted as described in BCP 14, RFC 2119 <xref
			format="default" pageno="false" target="RFC2119" />.
		</t>
    </section>

	
    <section title="Applicability Statement" toc="default">
		<t>
			The mechanism in this specification only applies to the Session Description Protocol (SDP)
			<xref format="default" pageno="false" target="RFC4566"/>, when used together with the 
			SDP Offer/Answer mechanism <xref format="default" pageno="false" target="RFC3264"/>.
		</t>
    </section>
	
	<section title="SDP Grouping Framework BUNDLE Extension" anchor="sec-group" toc="default">
		<section title="General" anchor="sec-group-gen" toc="default">
			<t>
				This section defines a new SDP Grouping Framework extension
				<xref format="default" pageno="false" target="RFC5888"/>, 'BUNDLE'. The
				BUNDLE extension can be used with the Session Description Protocol (SDP) Offer/Answer
				mechanism to negotiate the usage of a single 5-tuple for sending and receiving media,
				referred to as bundled media, associated with multiple SDP media descriptions ("m=" lines).
				Within a successfully created BUNDLE group, media described with "m=" lines associated 
				with the BUNDLE group will be sent and received using a single 5-tuple.
			</t>
			<t>
				The BUNDLE extension is indicated using an SDP 'group' attribute
				with a "BUNDLE" semantics value <xref format="default" pageno="false" 
				target="RFC5888"/>. An SDP "mid" attribute is assigned to each
				bundled "m=" line, and the "mid" attribute value is listed in the
				'group:BUNDLE' attribute mid value list. Each "m=" line, whose mid
				value is listed in the mid value list, is associated with a given BUNDLE
				group.
			</t>
			<t>
				SDP bodies can contain multiple BUNDLE groups. Any given bundled "m=" 
				line MUST NOT be associated with more than one BUNDLE group.
			</t>
			<t>
				[<xref target="sec-sdp-oa" pageno="false" format="default"/>] defines the 
				detailed SDP Offer/Answer procedures for the BUNDLE extension.
			</t>
		</section>	
	</section>
	
	<section anchor="sec-bundle-only" title="SDP 'bundle-only' Attribute" toc="default">
		<section anchor="sec-bundle-only-gen" title="General" toc="default">
			<t>
				This section defines a new SDP media-level attribute <xref target="RFC4566" pageno="false" 
				format="default"/>, 'bundle-only'.
			</t>
			<t>
				The 'bundle-only' attribute can be associated with a bundled "m=" line in an offer, to
				request that the answerer only accepts the "m=" line if the answerer keeps the "m=" line
				within the associated BUNDLE group.
				In order to ensure that an answerer that does not supports the BUNDLE extension always
				rejects a 'bundle-only' "m=" line, the offerer can assign a zero port value to the "m="
				line. According to <xref target="RFC4566" pageno="false" format="default"/> an answerer 
				will reject such "m=" line.
				The usage of the 'bundle-only' attribute is only defined for a bundled "m=" line within
				an offer. Other usage is unspecified.
			</t>
			<t>
				[<xref target="sec-sdp-oa" pageno="false" format="default"/>] defines the detailed SDP 
				Offer/Answer procedures for the 'bundle-only' attribute.
			</t>
		</section>
		<section anchor="sec-bundle-only-syntax" title="Syntax" toc="default">
			<t>
				This section defines the Augmented Backus-Naur Form (ABNF)
				<xref target="RFC5234" pageno="false" format="default"/>
				for the SDP 'bundle-only' attribute, based on the SDP
				<xref target="RFC4566" pageno="false" format="default"/>
				grammar.
			</t>
			<figure>
				<preamble></preamble>
				<artwork><![CDATA[
					
      attribute               =/ bundle-only-attribute
	  
	  bundle-only-attribute   = "bundle-only"

				]]></artwork>
			</figure>
		</section>	
	</section>

	<section title="SDP Information Considerations" anchor="sec-sdp-cons" toc="default">				
		<section title="General" anchor="sec-sdp-cons-gen" toc="default">
			<t>
				This section describes restrictions associated with the usage of
				SDP parameters within a BUNDLE group. It also describes, when parameter 
				and attribute values have been assigned to each bundled "m=" line, how to 
				calculate a value for the whole BUNDLE group.
			</t>
		</section>			
		<section title="Connection Data (c=)" anchor="sec-sdp-cons-c" toc="default">
			<t>
				The "c=" line nettype value <xref format="default" pageno="false" 
				target="RFC4566"/> assigned to a bundled "m=" line MUST be 'IN'.
			</t>
			<t>
				The "c=" line addrtype value <xref format="default" pageno="false" 
				target="RFC4566"/> assigned to a bundled "m=" line MUST be 'IP4' or 
				'IP6'. The same value MUST be assigned to each "m=" line.
			</t>
			<t>
				NOTE: Extensions to this specification can specify usage of the BUNDLE
				mechanism for other nettype and addrtype values than the ones listed above.
			</t>
		</section>									
		<section title="Bandwidth (b=)" anchor="sec-sdp-cons-b" toc="default">
			<t>
				The proposed bandwidth for a bundled "m=" line SHOULD be calculated
				in the same way as for a non-bundled "m=" line.
			</t>
			<t>
				The total proposed bandwidth for a BUNDLE group is the sum of the
				proposed bandwidth for each bundled "m=" line.
			</t>
			<t>
				The total proposed bandwidth for an offer or answer is the sum of
				the proposed bandwidth for each "m=" line (bundled and non-bundled)
				within the offer or answer.
			</t>
		</section>						
		<section title="Attributes (a=)" anchor="sec-sdp-cons-a" toc="default">
		    <t> 
				An offerer and answerer MUST use the rules and restrictions defined
				in <xref target="I-D.mmusic-sdp-mux-attributes" /> for when
				associating SDP attributes with bundled "m=" lines.
			</t>
		</section>
	</section>

	<section title="SDP Offer/Answer Procedures" anchor="sec-sdp-oa" toc="default">
		<section anchor="sec-sdp-oa-gen" title="General" toc="default">
			<t>
				This section describes the SDP Offer/Answer <xref format="default" 
				pageno="false" target="RFC3264"/> procedures for:
				<list style="symbols">
					<t>
						Negotiating and creating of a BUNDLE group;
					</t>
					<t>
						Selecting the BUNDLE addresses (offerer BUNDLE address and answerer BUNDLE address);
					</t>
					<t>
						Adding an "m=" line to a BUNDLE group;
					</t>
					<t>
						Moving an "m=" line out of a BUNDLE group; and
					</t>
					<t>
						Disabling an "m=" line within a BUNDLE group.
					</t>
				</list>
			</t>
			<t>
				The generic rules and procedures defined in <xref format="default" pageno="false" 
				target="RFC3264"/> and <xref format="default" pageno="false" target="RFC5888"/> 
				also apply to the BUNDLE extension. For example, if an offer is rejected
				by the answerer, the previously negotiated SDP parameters and characteristics 
				(including those associated with a BUNDLE group) apply. Hence, if an offerer
				generates an offer in which the offerer wants to create a BUNDLE group,
				and the answerer rejects the offer, the BUNDLE group is not created.
			</t>
			<t>
				The procedures in this section are independent of the media type or transport
				protocol represented by a bundled "m=" line. [<xref format="default" pageno="false" 
				target="sec-rtp"/>] defines additional considerations for RTP based media. 
				[<xref format="default" pageno="false" target="sec-bundle-only"/>] defines 
				additional considerations for the usage of the SDP 'bundle-only' attribute. 
				[<xref format="default" pageno="false" target="sec-ice"/>] defines additional 
				considerations for the usage of Interactive Connectivity Establishment (ICE) 
				mechanism <xref format="default" pageno="false" target="RFC5245"/>.
			</t>
			<t>
				The offerer and answerer MUST follow the rules and restrictions defined
				in [<xref format="default" pageno="false" target="sec-sdp-cons"/>] when
				creating offers and answers.
			</t>
			<t>
				SDP bodies can contain multiple BUNDLE groups. The procedures in this 
				section apply independently to a given BUNDLE group.		
			</t>
		</section>
		<section anchor="sec-sdp-oa-ino" title="Generating the Initial SDP Offer" toc="default">
			<section anchor="sec-sdp-oa-ino-gen" title="General" toc="default">
				<t>
					When an offerer generates an initial offer, in order to create a
					BUNDLE group, it MUST:
					<list style="symbols">
						<t>
							Assign a unique address to each "m=" line within the offer, following the procedures
							in <xref target="RFC3264" pageno="false" format="default"/>;
						</t>
						<t>
							Assign an SDP 'group:BUNDLE' attribute to the offer;
						</t>
						<t>
							Place the SDP 'mid' attribute value <xref target="RFC5888" pageno="false" format="default"/>
							of each bundled "m=" line to the SDP 'group:BUNDLE' attribute mid value list; and
						</t>
						<t>
							Indicate which unique address the offerer wants the answerer to select as the
							offerer BUNDLE address [<xref target="sec-sdp-oa-ino-req" pageno="false" 
							format="default"/>].
						</t>
					</list>
				</t>
				<t>
					If the offerer wants to request that the answerer accepts a given "m=" line only if
					the answerer keeps the "m=" line within the BUNDLE group, the offerer MUST:
					<list style="symbols">
						<t>
							Associate an SDP 'bundle-only' attribute [<xref target="sec-sdp-oa-ino-req" pageno="false" 
							format="default"/>] with the "m=" line; and
						</t>
						<t>
							Assign a zero port value to the "m=" line.
						</t>
					</list>
				</t>
				<t>
					NOTE: If the offerer assigns a zero port value to an "m=" line, but does not also associate an 
					SDP 'bundle-only' attribute with the "m=" line, it is an indication that the offerer wants to disable the "m=" 
					line [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
				</t>
				<t>
					[<xref target="sec-example-add" pageno="false" format="default"/>] shows 
					an example of an initial offer.
				</t>
			</section>
			<section title="Request offerer BUNDLE address selection" anchor="sec-sdp-oa-ino-req" toc="default">
				<t>
					In the offer, the address assigned to the "m=" line associated with the offerer suggested BUNDLE
					mid indicates the address that the offerer wants the answer to select as the
					offerer BUNDLE address [<xref format="default" pageno="false" target="sec-sdp-oa-ans-off"/>].
				</t>
			</section>
		</section>
		
		<section anchor="sec-sdp-oa-ans" title="Generating the SDP Answer" toc="default">
			<section title="General" anchor="sec-sdp-oa-ans-gen" toc="default">
				<t>
					When an answerer generates an answer, which contains a BUNDLE group, the following general 
					SDP grouping framework restrictions, defined in <xref target="RFC5888" pageno="false" 
					format="default"/>, also apply to the BUNDLE group:
					<list style="symbols">
						<t>
							The answerer MUST NOT include a BUNDLE group in the answer, unless the 
							offerer requested the BUNDLE group to be created in the associated offer; and
						</t>
						<t>
							The answerer MUST NOT include an "m=" line within a BUNDLE group, unless
							the offerer requested the "m=" line to be within that BUNDLE group in the 
							associated offer.
						</t>
					</list>
				</t>
				<t>
					If the answer contains a BUNDLE group, the answerer MUST:
					<list style="symbols">
						<t>
							Select an Offerer BUNDLE Address [<xref target="sec-sdp-oa-ans-off" 
							pageno="false" format="default"/>]; and
						</t>
						<t>
							Select an Answerer BUNDLE Address [<xref target="sec-sdp-oa-ans-ans" 
							pageno="false" format="default"/>];
						</t>
					</list>
				</t>
				<t>
					The answerer is allowed to select a new Answerer BUNDLE address each time it
					generates an answer to an offer.
				</t>
				<t>
					If the answerer does not want to keep an "m=" line within a BUNDLE group, it MUST:
					<list style="symbols">
						<t>
							Move the "m=" line out of the BUNDLE group [<xref target="sec-sdp-oa-ans-mov" 
							pageno="false" format="default"/>]; or
						</t>
						<t>
							Reject the "m=" line [<xref target="sec-sdp-oa-ans-rej" pageno="false" 
							format="default"/>];							
						</t>
					</list>
				</t>
				<t>
					If the answerer keeps a bundle-only "m=" line within the BUNDLE group,
					it follows the procedures (assigns the answerer BUNDLE address to the "m=" 
					line etc) for any other "m=" line kept within the BUNDLE group.
				</t>
				<t>
					If the answerer does not want to keep a bundle-only "m=" line within the
					BUNDLE group, it MUST reject the "m=" line [<xref target="sec-sdp-oa-ans-rej" 
					pageno="false" format="default"/>].
				</t>
				<t>
					The answerer MUST NOT include a 'bundle-only' attribute in an answer."
				</t>
				<t>
					NOTE: If a bundled "m=" line in an offer contains a port zero value, but the "m=" line does not contain
					an SDP 'bundle-only' attribute, it is an indication that the offerer wants to disable the "m=" 
					line [<xref target="sec-sdp-oa-mod-dis" pageno="false" format="default"/>].
				</t>
			</section>
					
			<section title="Answerer Selection of Offerer Bundle Address" anchor="sec-sdp-oa-ans-off" toc="default">
				<t>
					In an offer, the address (unique or shared) assigned to the bundled "m=" line associated with the offerer 
					suggested BUNDLE mid indicates the address that the offerer wants the answer to select as the offerer 
					BUNDLE address [<xref target="sec-sdp-oa-ino-req" pageno="false" format="default"/>]. The answerer
					MUST check whether the "m=" line fulfils the following criteria:
					<list style="symbols">
						<t>
							The answerer will not move the "m=" line out of the BUNDLE group
							[<xref target="sec-sdp-oa-ans-mov" pageno="false" format="default"/>];
						</t>
						<t>
							The answerer will not reject the "m=" line [<xref target="sec-sdp-oa-ans-rej" 
							pageno="false" format="default"/>]; and
						</t>
						<t>
							The "m=" line does not contain a zero port value.
						</t>
					</list>
				</t>
				<t>
					If all of the criteria above is fulfilled, the answerer MUST select the address
					associated with the "m=" line as the offerer BUNDLE address. In the answer, the
					answerer selected BUNDLE mid represents the "m=" line, and the address associated 
					with the "m=" line in the offer becomes the offerer BUNDLE address.
				</t>
				<t>
					If all of the criteria is not fulfilled, the answerer MUST select the next mid 
					value in the mid list, and perform the same criteria check for the "m=" line 
					associated with that mid value. If there are no more mid values in the mid list,
					the answerer MUST NOT create the BUNDLE group.
				</t>
				<t>
					[<xref target="sec-example-add" pageno="false" format="default"/>] shows an 
					example of an offerer BUNDLE address selection.
				</t>
			</section>
				
			<section title="Answerer Selection of Answerer BUNDLE Address" anchor="sec-sdp-oa-ans-ans" toc="default">			
				<t>
					When the answerer selects a BUNDLE address for itself, referred to as the answerer
					BUNDLE address, it MUST assign the address to each bundled "m=" line within the 
					created BUNDLE group in the answer.
				</t>
				<t>
					The answerer MUST NOT assign the answerer BUNDLE address to an "m=" line that is
					not within the BUNDLE group, or to an "m=" line that is within another BUNDLE group.
				</t>
				<t>
					[<xref target="sec-example-add" pageno="false" format="default"/>] shows an example of an
					answerer BUNDLE address selection.
				</t>
			</section>
			
			<section title="Moving A Media Description Out Of A BUNDLE Group" anchor="sec-sdp-oa-ans-mov" toc="default">	
				<t>
					When an answerer moves a "m=" line out of a BUNDLE group, it assigns an 
					address to the "m=" line in the answer based on the following rules:
					<list style="symbols">
					<t>
						In the associated offer, if the "m=" line contains a shared address (e.g. a 
						previously selected offerer BUNDLE address), the answerer MUST reject the
						moved "m=" line [<xref target="sec-sdp-oa-ans-rej" pageno="false" 
						format="default"/>];
					</t>
					<t>
						In the associated offer, if the "m=" line contains a unique address, the
						answerer MUST assign a unique address to the "m=" line in the answer; or
					</t>
					<t>
						In the associated offer, if the "m=" line contains an SDP 'bundle-only' 
						attribute the answerer MUST reject the "m=" line [<xref target="sec-sdp-oa-ans-rej" 
						pageno="false" format="default"/>].
					</t>
					</list>
				</t>
				<t>
					In addition, in either case above, the answerer MUST NOT include a mid value, associated
					with the moved "m=" line, in the SDP 'group:BUNDLE' attribute mid list associated
					with the BUNDLE group.
				</t>
			</section>
				
			<section title="Rejecting A Media Description In A BUNDLE Group" anchor="sec-sdp-oa-ans-rej" toc="default">			
				<t>
					When an answerer rejects an "m=" line, it MUST assign an address with a zero port 
					value to the "m=" line in the answer, according to the procedures in <xref 
					target="RFC4566" pageno="false" format="default"/>.
				</t>
				<t>
					In addition, the answerer MUST NOT include a mid value, associated
					with the rejected "m=" line, in the SDP 'group:BUNDLE' attribute mid list 
					associated with the BUNDLE group.
				</t>
			</section>						
		</section>
		
		<section anchor="sec-sdp-oa-off-ans" title="Offerer Processing of the SDP Answer" toc="default">
			<section title="General" anchor="sec-sdp-oa-off-ans-gen" toc="default">	
				<t>
					When an offerer receives an answer, if the answer contains a BUNDLE group, the offerer
					MUST check that any bundled "m=" line in the answer was indicated as bundled in the
					associated offer. If there is no mismatch, the offerer MUST apply the offerer BUNDLE 
					address, selected by the answerer [<xref format="default" pageno="false" 
					target="sec-sdp-oa-ans-off"/>], to each bundled "m=" line. 									
				</t>
				<t>
					NOTE: As the answerer might reject one or more bundled "m=" lines, or move a bundled
					"m=" line out of a BUNDLE group, each bundled "m=" line in the offer might not be
					indicated as bundled in the answer.
				</t>				
				<t>
					If the answer does not contain a BUNDLE group, the offerer MUST process the answer
					as a normal answer.
				</t>
			</section>
				
			<section title="Bundle Address Synchronization (BAS)" anchor="sec-sdp-oa-off-ans-bas" toc="default">	
				<t>
					When an offerer receives an answer, if the answer contains a BUNDLE group, the offerer MUST 
					check whether the offerer BUNDLE address, selected by the answerer [<xref format="default" pageno="false" 
					target="sec-sdp-oa-ans-off"/>], matches what was assigned to each bundled "m=" line (excluding any
					bundled "m=" line that was rejected, or moved out of the BUNDLE group, by the answer) 
					in the associated offer. If there is a mismatch, the offerer SHOULD as soon as possible
					generate a subsequent offer, in which it assigns the offerer BUNDLE address to each
					bundled "m=" line. Such offer is referred to as a Bundle Address Synchronization (BAS) offer.
				</t>
				<t>
					A BAS offer is typically sent in the following scenarios:
					<list style="symbols">
					<t>
						The offerer receives an answer to an initial offer, as the bundled "m=" lines
						in the initial offer always contain unique addresses [<xref target="sec-sdp-oa-ino" 
						pageno="false" format="default"/>]; or
					</t>
					<t>
						The offerer receives an answer to an offer, in which a new bundled "m=" line has 
						been added to the BUNDLE group [<xref target="sec-sdp-oa-mod-add" pageno="false" 
						format="default"/>], and the offerer assigned a unique address to the bundled
						"m=" line in the offer.
					</t>
					</list>
				</t>
				<t>
					The offerer is allowed to modify any SDP parameter in the BAS offer.					
				</t>
				<t>
					NOTE: It is important that the BAS offer gets accepted by the
					answerer. For that reason the offerer needs to consider the 
					necessity to modify SDP parameters in the BAS offer, in such a way
					that could trigger the answerer to reject the BAS offer. 
					Disabling "m=" lines, or reducing the number of codecs, in a BAS 
					offer is considered to have a low risk of being rejected.
				</t>
				<t>
					NOTE: The main purpose of the BAS offer is to ensure that
					intermediaries, that might not support the BUNDLE extension, have
					correct information regarding the address is going to be used to
					transport the bundled media.
				</t>
				<t>
					[<xref target="sec-example-add" pageno="false" format="default"/>] 
					shows an example of a BAS offer.
				</t>
			</section>
		</section>
		
		<section title="Modifying the Session" anchor="sec-sdp-oa-mod" toc="default">	
			<section title="General" anchor="sec-sdp-oa-mod-gen" toc="default">	
				<t>
					When an offerer generates a subsequent offer, it MUST assign
					the previously selected offerer BUNDLE address [<xref format="default" 
					pageno="false" target="sec-sdp-oa-ans-off"/>], to each bundled "m=" line 
					(including any bundle-only "m=" line), with the following exceptions:
					<list style="symbols">
						<t>
							The offerer wants to request the answerer to select a new offerer
							BUNDLE address [<xref target="sec-sdp-oa-mod-req" pageno="false" 
							format="default"/>];
						</t>
						<t>
							The offerer wants to add a bundled "m=" line to the BUNDLE group
							[<xref target="sec-sdp-oa-mod-add" pageno="false" format="default"/>];
						</t>
						<t>
							The offerer wants to move a bundled "m=" line out of the BUNDLE group
							[<xref target="sec-sdp-oa-mod-mov" pageno="false" format="default"/>]; or
						</t>
						<t>
							The offerer wants to disable the bundled "m=" line [<xref format="default" 
							pageno="false" target="sec-sdp-oa-mod-dis"/>].
						</t>
					</list>
				</t>
				<t>					
					In addition, the offerer MUST select an offerer suggested BUNDLE mid
					[<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>], even
					if the offerer does not want the answerer to select a new offerer BUNDLE
					address.
				</t>
				<t> 
					If the offerer associates an SDP 'bundle-only' attribute with a bundled "m=" line in
					the subsequent offer, if MUST assign the offerer BUNDLE address to
					the "m=" line. The offerer MUST NOT assign a unique address, or a
					zero port value, to a bundle-only "m=" line in a subsequent offer.
				</t>
				<t>
					NOTE: The offerer can associate an SDP 'bundle-only' attribute with a 
					bundled "m=" line in a subsequent offer, even if the offerer did not 
					associate a 'bundle-only' attribute with the same "m=" line in a previous offer.
				</t>
			</section>
			<section title="Request a new offerer BUNDLE address" anchor="sec-sdp-oa-mod-req" toc="default">
				<t>
					When an offerer generates an offer, in which it wants the answerer to select a new
					offerer BUNDLE address [<xref target="sec-sdp-oa-ino-req" pageno="false" format="default"/>],
					the offerer MUST:
					<list style="symbols">
						<t>
							Assign a unique address, which the offerer wants the answerer to select as
							the offerer BUNDLE address, to a bundled "m=" line; and
						</t>
						<t>
							Indicate that the offerer wants the answerer to select the unique address as the
							offerer BUNDLE address [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>]
						</t>
					</list>
				</t>
				<t>
					NOTE: The offerer can assign a unique address to each bundled "m=" line in the offer, or 
					it can assign the previously negotiated offerer BUNDLE address to each "m=" line 
					(except the "m=" line to which it assigns the unique address that it wants the answerer to 
					select as the new offerer BUNDLE address).
				</t>
			</section>						
			<section title="Adding a media description to a BUNDLE group" anchor="sec-sdp-oa-mod-add" toc="default">
				<t>
					When an offerer generates an offer, in which it wants to add a bundled "m=" line
					to BUNDLE group, the offerer MUST:
					<list style="symbols">
					<t>
						Assign a unique address (excluding bundle-only "m=" lines), or the offerer 
						BUNDLE address (selected by the answerer in a previous offer/answer transaction), 
						to the "m=" line;
					</t>
					<t>
						Place the SDP 'mid' attribute value associated with the "m=" line in the SDP 'group:BUNDLE' 
						attribute mid list associated with the BUNDLE group [<xref format="default" pageno="false" 
						target="sec-sdp-oa-ino-req"/>].
					</t>
					</list>
				</t>
				<t>
					NOTE: Adding a unique address to the "m=" line allows the answerer
					to move the "m=" line out of the BUNDLE group [<xref format="default" pageno="false" 
					target="sec-sdp-oa-ans-mov"/>], without having to reject the "m=" line.
				</t>
				<t>
					If the offerer wants the answerer to select the address
					associated with the added "m=" line as the new offerer BUNDLE 
					address, the offerer suggested BUNDLE mid MUST represent the added "m=" 
					line [<xref format="default" pageno="false" target="sec-sdp-oa-ino-req"/>].
				</t>
				<t>
					If the offerer associates an SDP 'bundle-only' attribute with the added "m=" line,
					the offerer MUST assign the offerer BUNDLE address (selected by the answerer in 
					a previous offer/answer transaction) to the "m=" line.
				</t>
				<t>
					[<xref target="sec-example-off-add" pageno="false" format="default"/>] 
					shows an example where an offerer sends an offer in order to
					add a bundled "m=" line to a BUNDLE group.
				</t>
			</section>						
			<section title="Moving A Media Description Out Of A BUNDLE Group" anchor="sec-sdp-oa-mod-mov" toc="default">				
				<t>
					When an offerer generates an offer, in which it wants to move a bundled "m=" line out
					of a BUNDLE group it was added to in a previous offer/answer transaction, the offerer:
					<list style="symbols">
						<t>
							MUST assign a unique address to the "m=" line;
						</t>
						<t>
							MUST NOT place a mid value associated with the "m=" line in the SDP 'group:BUNDLE' 
							attribute mid list associated with that BUNDLE group; and
						</t>
						<t>
							MUST NOT associate an SDP 'bundle-only' attribute with the "m=" line.
						</t>
					</list>
				</t>
				<t>
					NOTE: If an "m=" line, when being moved out of a BUNDLE group, is added to 
					another BUNDLE group, the offerer applies the procedures in 
					[<xref target="sec-sdp-oa-mod-add" pageno="false" format="default"/>] to 
					the "m=" line.
				</t>
				<t>
					[<xref target="sec-example-off-mov" pageno="false" format="default"/>] 
					shows an example of an offer for moving an "m=" line out of a BUNDLE group.					
				</t>
			</section>
			<section title="Disabling A Media Description In A BUNDLE Group" anchor="sec-sdp-oa-mod-dis" toc="default">
				<t>
					When an offerer generates an offer, in which it wants to disable a bundled "m=" line (added
					to the BUNDLE group in a previous offer/answer transaction), the offerer:
					<list style="symbols">
						<t>
							MUST assign an address with a zero port value to the "m=" line, 
							following the procedures in <xref target="RFC4566" pageno="false" 
							format="default"/>;
						</t>
						<t>
							MUST NOT place a mid value associated with the "m=" line in the SDP 'group:BUNDLE' 
							attribute mid list associated with the BUNDLE group; and
						</t>
						<t>
							MUST NOT associate an SDP 'bundle-only' attribute with the "m=" line.
						</t>
					</list>
				</t>
				<t>
					[<xref target="sec-example-off-dis" pageno="false" format="default"/>] 
					shows an example of an offer for disabling an "m=" line within a 
					BUNDLE group.
				</t>
			</section>			
		</section>
	</section>
	
	<section title="Protocol Identification" anchor="sec-protocol-id" toc="default">
		<section title="General" anchor="sec-protocol-id-gen" toc="default">
			<t>
				If bundled "m=" lines represent different transport protocols, there MUST
				exist a publically available specification which describes a mechanism, for this 
				specific transport protocol combination, how to associate a received packet with
				the correct transport protocol.
			</t>
			<t>
				In addition, if a received packet can be associated with more than one
				bundled "m=" line, there MUST exist a publically available specification which 
				describes a mechanism how to associate the received packet with the correct "m=" line.
			</t>
		</section>
		<section anchor="sec-packets-id-sds" title="STUN, DTLS, SRTP" toc="default">
			<t>
				Section 5.1.2 of <xref format="default" pageno="false" target="RFC5764"/> describes a 
				mechanism how to identify the protocol among the STUN, DTLS and SRTP protocols (in any combination). 
				If an offer or answerer in offers or answers include bundled "m=" lines that represent these protocols, 
				the offerer or answerer MUST support the mechanism described in <xref format="default" pageno="false" 
				target="RFC5764"/>, and no explicit negotiation is required in order to indicate support 
				and usage of the mechanism. 
			</t>
			<t>
				<xref format="default" pageno="false" target="RFC5764"/> does not describe how to identify 
				different protocols transported on DTLS, only how to identify the DTLS protocol itself. If 
				multiple protocols are transported on DTLS, there MUST exist a specification describing a 
				mechanism how to identify each individual protocol. In addition, if a received DTLS packet 
				can be associated with more than one "m=" line, there MUST exist a specification which
				describes a mechanism how to associate the received DTLS packet with the correct "m=" line.
			</t>
			<t>
				[<xref format="default" pageno="false" target="sec-rtp-pt"/>] describes how to associate a received 
				(S)RTP packet with the correct "m=" line.
			</t>
		</section>
	</section>
	
	
	<section anchor="sec-rtp" title="RTP Considerations" toc="default">
		<section anchor="sec-rtp-sessions" title="Single RTP Session" toc="default">
			<section anchor="sec-rtp-sessions-gen" title="General" toc="default">
					<t>
						All RTP-based media within a single BUNDLE group belong to a 
						single RTP session <xref format="default" pageno="false" 
						target="RFC3550"/>. Disjoint BUNDLE groups will form multiple 
						RTP sessions, one per BUNDLE group.
					</t>
					<t>
						Since a single RTP session is used for each bundle group, all 
						"m=" lines representing RTP-based media in a bundle group will 
						share a single SSRC numbering space <xref format="default" 
						pageno="false" target="RFC3550"/>.
					</t>
					<t>
						The following rules and restrictions apply for a single RTP
						session:
					</t>
					<t>
						<list style="symbols">
							<t>A specific payload type value can be used in multiple bundled "m=" lines 
							if each codec associated with the payload type number shares an identical 
							codec configuration
                                                        [<xref format="default"
                                                        pageno="false"
                                                        target="sec-rtp-sessions-pt"/>].</t>

							<t>The "proto" value in
                                                        each bundled "m=" line
                                                        MUST be identical
                                                        (e.g. RTP/AVPF).</t>

							<t>A given SSRC SHOULD NOT transmit RTP packets using payload types that 
							originate from different bundled "m=" lines.</t>
						</list>				
					</t>		
					<t>
						NOTE: The last bullet above is to avoid sending multiple media types from the same SSRC. 
						If transmission of multiple media types are done with time overlap, RTP and RTCP fail 
						to function. Even if done in proper sequence this causes RTP Timestamp rate switching 
						issues [ref to draft-ietf-avtext-multiple-clock-rates].
					</t>
			</section>
			<section anchor="sec-rtp-sessions-pt" title="Payload Type (PT) Value Re-usage" toc="default">
					<t>
						Multiple bundled "m=" lines might represent RTP based media. As all RTP based 
						media associated with a BUNDLE group belong to the same RTP session, in order for a given payload type 
						value to used inside more than one bundled "m=" line, all codecs associated with the payload type 
						numbers MUST share an identical codec configuration. This means that the codecs MUST share the same media type, 
						encoding name, clock rate and any parameter that can affect the codec configuration and packetization. 
						<xref format="default" pageno="false" target="I-D.mmusic-sdp-mux-attributes"/> lists SDP
						attributes, whose attribute values must be identical for all codecs that use the same payload type value.
					</t>
			</section>
		</section>
		
		<section anchor="sec-rtp-pt" title="Associating RTP/RTCP Packets With Correct SDP Media Description" toc="default">
				<t>
					In general, there are multiple mechanisms that can be used by an endpoint in order to associate received 
					RTP/RTCP packets with the bundled "m=" line representing the RTP packets. Such mechanisms include using the local 
					address:port combination on which the RTP packets are received, the payload type value carried inside the RTP packets, 
					the SSRC values carried inside the RTP packets, and other "m=" line specific information carried inside 
					the RTP packets.
				</t>
				<t>
					As all RTP/RTCP packets associated with a BUNDLE group are sent and received using the same 5-tuple, the local address:port 
					combination cannot be used to associate received RTP packets with the correct "m=" line.
				</t>
				<t>
					As described in [<xref format="default" pageno="false" target="sec-rtp-sessions-pt"/>], the same payload 
					type value might be used inside RTP packets described by  multiple "m=" lines. In such cases, the payload 
					type value cannot be used to associate received RTP packets with the correct "m=" line.
				</t>
				<t>
					An offerer and answerer can in an offer and answer inform each other which SSRC values they will use 
					inside sent RTP/RTCP packets, by assigning an SDP 'ssrc' attribute <xref format="default" pageno="false" 
					target="RFC5576"/> to each bundled "m=" line which contains a payload type value that is also used inside 
					another bundled "m=" line. As the SSRC values will be carried inside the RTP/RTCP packets, the offerer and 
					answerer can then use that information to associate received RTP packets with the correct "m=" line. However, an 
					offerer will not know which SSRC values the answerer will use until it has received the answer 
					providing that information. Due to this, before the offerer has received the answer, the offerer will 
					not be able to associate received RTP/RTCP packets with the correct "m=" line using the SSRC values.
				</t>
				<t>
					In order for an offerer and answerer to always be able to associate received RTP and RTCP packets with the
					correct "m=" line, an offerer and answerer using the BUNDLE extension MUST use the mechanism defined in 
					[<xref format="default" pageno="false" target="sec-receiver-id"/>], where the remote endpoint inserts the 
					SDP 'mid' attribute value of an "m=" line in RTP and RTCP packets associated with that "m=" line.
				</t>
		</section>

		<section title="RTP/RTCP Multiplexing" anchor="sec-rtprtcp-mux" toc="default">
			<section title="General" anchor="sec-rtprtcp-mux-gen" toc="default">
					<t>
						When a BUNDLE group, which contains RTP based media, is created, the offerer
						and answerer MUST negotiate whether to enable RTP/RTCP multiplexing
						for the RTP based media associated with the BUNDLE group <xref format="default" 
						pageno="false" target="RFC5761"/>.
					</t>
					<t>
						If RTP/RTCP multiplexing is not enabled, separate 5-tuples will be used for sending
						and receiving the RTP packets and the RTCP packets.
					</t>
			</section>			
			<section title="SDP Offer/Answer Procedures" anchor="sec-rtprtcp-mux-oa" toc="default">
				<section title="General" anchor="sec-rtprtcp-mux-oa-gen" toc="default">
						<t>
							This section describes how an offerer and answerer can use the SDP 'rtcp-mux' attribute
							<xref format="default" pageno="false" target="RFC5761"/> and the SDP 'rtcp' attribute
							<xref format="default" pageno="false" target="RFC3605"/> to negotiate usage of RTP/RTCP 
							multiplexing for RTP based media associated with a BUNDLE group.
						</t>
				</section>			
				<section title="Generating the Initial SDP Offer" anchor="sec-rtprtcp-mux-oa-ino" toc="default">
						<t>
							When an offerer generates an initial offer, if the offerer wants to negotiate usage 
							of RTP/RTCP multiplexing within a BUNDLE group, the offerer MUST assign 
							an SDP 'rtcp-mux' attribute <xref format="default" pageno="false" target="RFC5761"/> to 
							each bundled "m=" line (including any bundle-only "m=" line) in the offer. In addition, the offerer 
							MUST assign an SDP 'rtcp' attribute <xref format="default" pageno="false" target="RFC3605"/> to each 
							bundled "m=" line (including any bundle-only "m=" line), with an attribute value that is identical to 
							the port value assigned to the "m=" line itself, in the offer.
						</t>
						<t>
							If the offerer does not want to negotiate usage of RTP/RTCP multiplexing, it MUST
							NOT assign the SDP attributes above to any bundled "m=" line.
						</t>
				</section>			
				<section title="Generating the SDP Answer" anchor="sec-rtprtcp-mux-oa-ans" toc="default">
						<t>
							When an answerer generates an answer, if the offerer indicated support of
							RTP/RTCP multiplexing <xref format="default" pageno="false" target="RFC5761"/> 
							within a BUNDLE group in the associated offer, the answerer MUST either accept
							or reject the usage of RTP/RTCP multiplexing in the answer.
						</t>
						<t>
							If the answerer accepts usage of RTP/RTCP multiplexing within the BUNDLE group, it 
							MUST assign an SDP 'rtcp-mux' attribute to each bundled "m=" line in the answer. The
							answerer MUST NOT assign an SDP 'rtcp' attribute to any bundled "m=" line in the answer.
						</t>
						<t>
							If the answerer rejects usage of RTP/RTCP multiplexing within the BUNDLE group, it
							MUST NOT assign an SDP 'rtcp-mux' or SDP 'rtcp' attribute to any bundled "m=" line in
							the answer.
						</t>
						<t>
							If the usage of RTP/RTCP multiplexing has been negotiated in a previous offer/answer
							transaction, and the offerer indicates that it wants to continue using RTP/RTCP
							multiplexing in a subsequent offer, the answerer MUST assign an SDP 'rtcp-mux' attribute
							to each bundled "m=" line in the answer. I.e. the answerer MUST NOT disable the usage of
							RTP/RTCP multiplexing. 
						</t>
				</section>
				<section title="Offerer Processing of the SDP Answer" anchor="sec-rtprtcp-mux-oa-pra" toc="default">
						<t>
							When the offerer receives an answer, if the answerer accepts the
							usage of RTP/RTCP multiplexing, by including an SDP 'rtcp-mux' attribute
							to each bundled "m=" line in the answer [<xref format="default" pageno="false" 
							target="sec-rtprtcp-mux-oa-ans"/>], the answerer follows the procedures
							for RTP/RTCP multiplexing defined in <xref format="default" pageno="false" 
							target="RFC5761"/>.
						</t>
						<t>
							If the answerer does not accept the usage of RTP/RTCP multiplexing
							[<xref format="default" pageno="false" target="sec-rtprtcp-mux-oa-ans"/>],
							the offerer MUST use separate 5-tuples for RTP and RTCP.
						</t>
				</section>				
				<section title="Modifying the Session" anchor="sec-rtprtcp-mux-oa-mod" toc="default">
							<t>
								When an offerer generates a subsequent offer, if it wants
								to negotiate usage of RTP/RTCP multiplexing within a BUNDLE group, or 
								if it wants to continue usage of RTP/RTCP multiplexing (negotiated in
								a previous offer/answer transaction), it MUST assign SDP 'rtcp-mux' 
								and 'rtcp' attributes to each bundled "m=" line (including bundle-only 
								"m=" lines, and a bundled "m=" line that the offerer wants to add to the
								BUNDLE group), unless the offerer wants to disable or remove the "m=" line 
								from the BUNDLE group.
							</t>
							<t>
								If the offerer does not want to negotiate usage of RTP/RTCP multiplexing
								within the BUNDLE group, or if it wants to disable usage of RTP/RTCP
								multiplexing (negotiated in a previous offer/answer transaction), the
								offerer MUST NOT assign SDP 'rtcp-mux' and 'rtcp' attributes to any
								bundled "m=" line in the subsequent offer.
							</t>
							<t>
								NOTE: It is RECOMMENDED that, once usage of RTP/RTCP multiplexing has been 
								negotiated within a BUNDLE group, that the usage is not disabled. Disabling 
								RTP/RTCP multiplexing means that the offerer and answerer need to
								reserve new IP ports, to be used for sending and receiving RTCP packets.
							</t>							
				</section>
			</section>			
		</section>
	</section>

	<section title="ICE Considerations" anchor="sec-ice" toc="default">
		<section title="General" anchor="sec-ice-gen" toc="default">
			<t>
				This section describes how to use the BUNDLE grouping extension together
				with the Interactive Connectivity Establishment (ICE) mechanism <xref 
				format="default" pageno="false" target="RFC5245"/>.
			</t>
			<t>
				The procedures defined in <xref format="default" pageno="false" target="RFC5245"/> also apply 
				to usage of ICE with BUNDLE, with the following exception:
			</t>
			<t>
				<list style="symbols">
					<t>
						When BUNDLE addresses for a BUNDLE group have been selected for both endpoints, ICE 
						connectivity checks and keep-alives only need to be performed for the whole BUNDLE group,
						instead of per bundled "m=" line.
					</t>
				</list>				
			</t>		
			<t>
				Support and usage of ICE mechanism together with the BUNDLE extension is OPTIONAL.
			</t>			
		</section>
		
		<section title="SDP Offer/Answer Procedures" anchor="sec-ice-oa" toc="default">
		
			<section title="General" anchor="sec-ice-oa-gen" toc="default">
				<t>
					When an offerer or answerer assigns a unique address to a bundled "m=" line (excluding
					bundle-only "m=" lines), it MUST also assign unique ICE candidates <xref format="default" 
					pageno="false" target="RFC5245"/> to the "m=" line.
				</t>
				<t>
					When an offerer or answerer assigns a shared address (i.e. a previously selected BUNDLE
					address) to one or more bundled "m=" line (including bundle-only "m=" lines), and when it assigns an 
					address with a zero port value to one or more bundle-only "m=" lines, it MUST assign identical
					ICE candidates (referred to as shared ICE candidates) to each of those "m=" lines.
				</t>
			</section>

			<section title="Generating the Initial SDP Offer" anchor="sec-ice-oa-ino" toc="default">
				<t>
					When an offerer generates an initial offer, it assigns unique or shared ICE candidates 
					to the bundled "m=" lines, according to [<xref format="default" pageno="false" 
					target="sec-ice-gen"/>].
				</t>
			</section>
			
			<section title="Generating the SDP Answer" anchor="sec-ice-oa-ans" toc="default">
				<t>
					When an answerer generates an answer, which contains a BUNDLE group, 
					the answerer MUST assign shared ICE candidates to each bundled "m=" line 
					(including "m=" lines that were indicated as bundle-only in the associated offer)
					in the answer.
				</t>
			</section>
			
			<section title="Offerer Processing of the SDP Answer" anchor="sec-ice-oa-pra" toc="default">
				<t>
					When an offerer receives an answer, if the answerer supports and uses the ICE
					mechanism and the BUNDLE extension, the offerer MUST assign the ICE candidates, 
					associated with the "m=" line representing the offerer BUNDLE address (selected by the 
					answerer) to each bundled "m=" line.
				</t>
			</section>
			
			<section title="Modifying the Session" anchor="sec-ice-oa-mod" toc="default">
				<t>
					When an offerer generates a subsequent offer, it assigns unique or shared ICE 
					candidates to the bundled "m=" lines, according to [<xref format="default" pageno="false" 
					target="sec-ice-gen"/>].
				</t>
			</section>		
		</section>
    </section>
	
	<section anchor="sec-3264" title="Update to RFC 3264" toc="default">
		<section anchor="sec-3264-gen" title="General" toc="default">
			<t>
				This section replaces the text of the following sections
				of RFC 3264:
			</t>
			<t>
				<list style="symbols">
					<t>Section 5.1 (Unicast Streams).</t>
					<t>Section 8.2 (Removing a Media Stream).</t>
					<t>Section 8.4 (Putting a Unicast Media Stream on Hold).</t>
				</list>				
			</t>		
		</section>
		<section anchor="sec-3264-old-5_1" title="Original text of section 5.1 (2nd paragraph) of RFC 3264" toc="default">
			<t>
				For recvonly and sendrecv streams, the port number and address in the
				offer indicate where the offerer would like to receive the media
				stream. For sendonly RTP streams, the address and port number
				indirectly indicate where the offerer wants to receive RTCP reports.
				Unless there is an explicit indication otherwise, reports are sent to
				the port number one higher than the number indicated.  The IP address
				and port present in the offer indicate nothing about the source IP
				address and source port of RTP and RTCP packets that will be sent by
				the offerer. A port number of zero in the offer indicates that the
				stream is offered but MUST NOT be used.  This has no useful semantics
				in an initial offer, but is allowed for reasons of completeness,
				since the answer can contain a zero port indicating a rejected stream
				(Section 6). Furthermore, existing streams can be terminated by
				setting the port to zero (Section 8). In general, a port number of
				zero indicates that the media stream is not wanted.
			</t>
		</section>
		<section anchor="sec-3264-new-5_1" title="New text replacing section 5.1 (2nd paragraph) of RFC 3264" toc="default">
			<t>
				For recvonly and sendrecv streams, the port number and address in the
				offer indicate where the offerer would like to receive the media
				stream. For sendonly RTP streams, the address and port number
				indirectly indicate where the offerer wants to receive RTCP reports.
				Unless there is an explicit indication otherwise, reports are sent to
				the port number one higher than the number indicated. The IP address
				and port present in the offer indicate nothing about the source IP
				address and source port of RTP and RTCP packets that will be sent by
				the offerer. A port number of zero in the offer by default indicates that the
				stream is offered but MUST NOT be used, but an extension mechanism
				might specify different semantics for the usage of a zero port value.  
				Furthermore, existing streams can be terminated by setting the port to 
				zero (Section 8). In general, a port number of zero by default indicates 
				that the media stream is not wanted.
			</t>
		</section>
		<section anchor="sec-3264-old-8_2" title="Original text of section 8.2 (2nd paragraph) of RFC 3264" toc="default">
			<t>
				A stream that is offered with a port of zero MUST be marked with port
				zero in the answer. Like the offer, the answer MAY omit all
				attributes present previously, and MAY list just a single media
				format from amongst those in the offer.
			</t>
		</section>
		<section anchor="sec-3264-new-8_2" title="New text replacing section 8.2 (2nd paragraph) of RFC 3264" toc="default">
			<t>
				A stream that is offered with a port of zero MUST by default be
				marked with port zero in the answer, unless an extension mechanism,
				which specifies semantics for the usage of a non-zero port value, is
				used. If the stream is marked with port zero in the answer, the answer 
				MAY omit (like the offer) all attributes present previously, and MAY list 
				just a single media format from amongst those in the offer."
			</t>
		</section>		
		<section anchor="sec-3264-old-8_4" title="Original text of section 8.4 (6th paragraph) of RFC 3264" toc="default">
			<t>
				RFC 2543 [10] specified that placing a user on hold was accomplished
				by setting the connection address to 0.0.0.0.  Its usage for putting
				a call on hold is no longer recommended, since it doesn't allow for
				RTCP to be used with held streams, doesn't work with IPv6, and breaks
				with connection oriented media.  However, it can be useful in an
				initial offer when the offerer knows it wants to use a particular set
				of media streams and formats, but doesn't know the addresses and
				ports at the time of the offer.  Of course, when used, the port
				number MUST NOT be zero, which would specify that the stream has been
				disabled.  An agent MUST be capable of receiving SDP with a
				connection address of 0.0.0.0, in which case it means that neither
				RTP nor RTCP should be sent to the peer.
			</t>
		</section>	
		<section anchor="sec-3264-new-8_4" title="New text replacing section 8.4 (6th paragraph) of RFC 3264" toc="default">
			<t>
				RFC 2543 [10] specified that placing a user on hold was accomplished
				by setting the connection address to 0.0.0.0.  Its usage for putting
				a call on hold is no longer recommended, since it doesn't allow for
				RTCP to be used with held streams, doesn't work with IPv6, and breaks
				with connection oriented media. However, it can be useful in an
				initial offer when the offerer knows it wants to use a particular set
				of media streams and formats, but doesn't know the addresses and
				ports at the time of the offer. Of course, when used, the port
				number MUST NOT be zero, if it would specify that the stream has been
				disabled. However, an extension mechanism might specify different
				semantics of the zero port number usage. An agent MUST be capable 
				of receiving SDP with a connection address of 0.0.0.0, in which case it 
				means that neither RTP nor RTCP should be sent to the peer.
			</t>
		</section>			
	</section>


    <section title="RTP/RTCP extensions for mid value transport" anchor="sec-receiver-id" toc="default">
		<section title="General" anchor="sec-receiver-id-gen" toc="default">
			<t>
				SDP Offerers and Answerers <xref format="default" pageno="false" target="RFC3264"/> can assign 
				mid values to SDP Media Descriptions (m= lines) within SDP Offers and Answers, using 
				the procedures in <xref format="default" pageno="false" target="RFC5888"/>. Each mid value
				uniquely identifies an m= line.
			</t>
			<t>
				This section defines a new RTP SDES item <xref format="default" pageno="false" target="RFC3550"/>, 'MID',
				which is used to carry mid values within RTCP SDES packets. This section also defines a new
				RTP header extension <xref format="default" pageno="false" target="RFC5285"/>, which can be used to carry
				the mid value in RTP packets.
			</t>
			<t>
				The SDES item and RTP header extension makes is possible for a receiver to associate received RTCP- and
				RTP packets with a specific m= line, to which the receiver has assigned a mid value, even if those m= lines 
				are part of the same RTP session. The endpoint informs the remote endpoint about the mid values using the 
				procedures in <xref format="default" pageno="false" target="RFC5888"/>, and the remote endpoint then inserts 
				the mid values in RTCP- and RTP packets sent towards the other endpoint.
			</t>
			<t>
				NOTE: This text above defines how the mid value is carried in SDP Offers and Answers. The usage of other 
				signalling protocols for carrying the mid value is not prevented, but the usage of such protocols is outside
				the scope of this document.			
			</t>
			<t>
				<xref format="default" pageno="false" target="RFC3550"/> defines general procedures regarding the RTCP transmission interval.
				The RTP MID SDES item SHOULD be sent in the first few RTCP packets sent on joining the session, and SHOULD be 
				sent regularly thereafter. The exact number of RTCP packets in which this SDES item is sent is 
				intentionally not specified here, as it will depend on the expected packet loss rate, the RTCP reporting interval, 
				and the allowable overhead.
			</t>
			<t>
				The RTP MID header extension SHOULD be included in some RTP packets at the start of the session and whenever 
				the SSRC changes. It might also be useful to include the header extension in RTP packets that comprise random 
				access points in the media (e.g., with video I-frames). The exact number of RTP packets in which this header extension 
				is sent is intentionally not specified here, as it will depend on expected packet loss rate and loss patterns, the 
				overhead the application can tolerate, and the importance of immediate receipt of the mid value.
			</t>
			<t>
				For robustness purpose, endpoints need to be prepared for situations where the mid value is delayed, and SHOULD NOT 
				terminate sessions in such cases, as the mid value is likely to arrive soon.		
			</t>
		</section>
		<section title="RTP MID SDES Item" anchor="sec-receiver-id-sdes-item" toc="default">
				<figure>
					<artwork align="left"><![CDATA[

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MID=TBD  |     length    | mid value                   ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

					]]></artwork>
				</figure>
				<t>
					The mid value payload is UTF-8 encoded, as in SDP.
				</t>
				<t>
					[RFC EDITOR NOTE: Please replace TBD with the assigned SDES 
					identifier value.]
				</t>			
		</section>		
		<section title="RTP MID Header Extension" anchor="sec-receiver-id-rtp-he" toc="default">
				<t>
					The payload, containing the mid value, of the RTP MID header extension element 
					can be encoded using either the one-byte or two-byte header <xref format="default" 
					pageno="false" target="RFC5285"/>. The mid value payload is UTF-8 encoded, as in SDP.
				</t>			
		</section>
	</section>
	<section title="IANA Considerations" anchor="sec-receiver-id-iana" toc="default">
		<section title="New SDES item" anchor="sec-receiver-id-iana-sdes-item" toc="default">
			<t>
				[RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number 
				of this document.]
			</t>
			<t>
				[RFC EDITOR NOTE: Please replace TBD with the assigned SDES 
				identifier value.]
			</t>			
			<t>			
				This document adds the MID SDES item to the IANA "RTP SDES item 
				types" registry as follows:
			</t>
			<figure>
				<artwork align="left"><![CDATA[

	Value:		TBD
	Abbrev.:	MID
	Name:		Media Identification
	Reference:	RFCXXXX

				]]></artwork>
			</figure>
		</section>
		<section title="New RTP Header Extension URI" anchor="sec-receiver-id-iana-rtp-uri" toc="default">
			<t>			
				This document defines a new extension URI in the RTP Compact Header
				Extensions subregistry of the Real-Time Transport Protocol (RTP)
				Parameters registry, according to the following data:
			</t>
			<figure>
				<artwork align="left"><![CDATA[

    Extension URI: urn:ietf:params:rtp-hdrext:sdes:mid
    Description:   Media identification
    Contact:       christer.holmberg@ericsson.com
    Reference:     RFCXXXX

				]]></artwork>
			</figure>
		</section>
		<section title="New SDP Attribute" anchor="sec-receiver-id-iana-sdp-attribute" toc="default">
			<t>			
				This document defines a new SDP media-level attribute,
				according to the following data:
			</t>
			<figure>
				<artwork align="left"><![CDATA[

	Attribute name:   	bundle-only
	Type of attribute:  Media-level
	Subject to charset: No
	Purpose:            Request a media description to be accepted
						in the answer only if kept within a BUNDLE group
						by the answerer
	Appropriate values:	N/A
	Contact name:      	Christer Holmberg
	Contact e-mail:		christer.holmberg@ericsson.com

				]]></artwork>
			</figure>
		</section>
	</section>
	
    <section title="Security Considerations" anchor="sec-security" toc="default">
		<t>
			The security considerations defined in <xref format="default" 
			pageno="false" target="RFC3264"/> and <xref format="default" 
			pageno="false" target="RFC5888"/> apply to the BUNDLE
                        extension. Bundle does not change which information
                        flows over the network but only changes which ports that
                        information if flowing on and thus has very little
                        impact on the security of the RTP sessions. 
		</t>
		<t>
			When the BUNDLE extension is used, a single set of security credentials
			might be used for all media streams associated with a BUNDLE group. 
		</t>
    </section>
	
	<section title="Examples" anchor="sec-example-alt1" toc="default">
		<section title="Example: Bundle Address Selection" anchor="sec-example-add" toc="default">
			<t>
				The example below shows:
				<list style="symbols">
					<t>1. An offer, in which the offerer assigns a unique address to each bundled "m=" line within the BUNDLE group.</t>
					<t>2. An answer, in which the answerer selects the offerer BUNDLE address, and in which selects its own BUNDLE 
					address (the answerer BUNDLE address) and assigns it each bundled "m=" line within the BUNDLE group.</t>
					<t>3. A subsequent offer (BAS offer), which is used to perform a Bundle Address Synchronization (BAS).</t>
				</list>				
			</t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10002 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    m=video 20000 RTP/AVP 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:32 MPV/90000


SDP Offer (3)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000

]]></artwork>
        </figure>
		</section>
				
		<section title="Example: BUNDLE Extension Rejected" anchor="sec-example-bunrej" toc="default">
			<t>
				The example below shows:
				<list style="symbols">
					<t>1. An offer, in which the offerer assigns a unique address to each bundled "m=" line within the BUNDLE group.</t>
					<t>2. An answer, in which the answerer rejects the offered BUNDLE group, and assigns a unique addresses 
					to each "m=" line (following normal RFC 3264 procedures).</t>					
				</list>				
			</t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10002 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000


SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0         
    m=audio 20000 RTP/AVP 0         
    b=AS:200
    a=rtpmap:0 PCMU/8000
    m=video 30000 RTP/AVP 32         
    b=AS:1000
    a=rtpmap:32 MPV/90000
	

]]></artwork>
        </figure>
		</section>
		
		
		<section title="Example: Offerer Adds A Media Description To A BUNDLE Group" anchor="sec-example-off-add" toc="default">
			<t>
				The example below shows:
				<list style="symbols">
					<t>1. An offer, in which the offerer adds a new "m=" line, represented by the "zen" mid value, 
					to a previously negotiated BUNDLE group, assigns a unique address to the added "m=" line, and assigns 
					the previously selected offerer BUNDLE address to each of the other bundled "m=" lines within the BUNDLE group.</t>
					<t>2. An answer, in which the answerer assigns the answerer BUNDLE address to each bundled "m=" line 
					(including the newly added "m=" line) within the BUNDLE group.</t>
					<t>3. A subsequent offer (BAS offer), which is used to perform a Bundle Address Synchronization (BAS).</t>
				</list>				
			</t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    m=video 20000 RTP/AVP 66
    a=mid:zen
    b=AS:1000
    a=rtpmap:66 H261/90000
    

SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 20000 RTP/AVP 0
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    m=video 20000 RTP/AVP 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:32 MPV/90000
    m=video 20000 RTP/AVP 66
    a=mid:zen
    b=AS:1000
    a=rtpmap:66 H261/90000

	
SDP Offer (3)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar zen
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    m=video 10000 RTP/AVP 66
    a=mid:zen
    b=AS:1000
    a=rtpmap:66 H261/90000

	
]]></artwork>
        </figure>
		</section>

		<section title="Example: Offerer Moves A Media Description Out Of A BUNDLE Group" anchor="sec-example-off-mov" toc="default">
			<t>
				The example below shows:
				<list style="symbols">
					<t>1. An offer, in which the offerer moves a bundled "m=" line out of a BUNDLE group, assigns a unique address to 
					the moved "m=" line, and assigns the offerer BUNDLE address to each other bundled "m=" line within the BUNDLE group.</t>
					<t>2. An answer, in which the answerer moves the "m=" line out of the BUNDLE group, assigns unique address to 
					the moved "m=" line, and assigns the answerer BUNDLE address to each other bundled "m=" line within the BUNDLE group.</t>					
				</list>				
			</t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    m=video 50000 RTP/AVP 66
    b=AS:1000
    a=rtpmap:66 H261/90000
    

SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    m=video 20000 RTP/AVP 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:32 MPV/90000
    m=video 60000 RTP/AVP 66    
    b=AS:1000
    a=rtpmap:66 H261/90000

	
]]></artwork>
        </figure>
		</section>		
		
				<section title="Example: Offerer Disables A Media Description Within A BUNDLE Group" anchor="sec-example-off-dis" toc="default">
			<t>
				The example below shows:
				<list style="symbols">
					<t>1. An offer, in which the offerer disables a bundled "m=" line within BUNDLE group, assigns a zero port number  
					the disabled "m=" line, and assigns the offerer BUNDLE address to each of the other bundled
					"m=" lines within the BUNDLE group.</t>
					<t>2. An answer, in which the answerer moves the disabled "m=" line out of the BUNDLE group, assigns a zero port value 
					to the disabled "m=" line, and assigns the answerer BUNDLE address to each of the other bundled "m=" lines within
					the BUNDLE group.</t>					
				</list>				
			</t>
          <figure>
          <artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer (1)

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 10000 RTP/AVP 0 8 97
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    a=rtpmap:8 PCMA/8000
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 31 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:31 H261/90000
    a=rtpmap:32 MPV/90000
    m=video 0 RTP/AVP 66    
    a=rtpmap:66 H261/90000
    

SDP Answer (2)

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    a=group:BUNDLE foo bar
    m=audio 20000 RTP/AVP 0
    a=mid:foo
    b=AS:200
    a=rtpmap:0 PCMU/8000
    m=video 20000 RTP/AVP 32
    a=mid:bar
    b=AS:1000
    a=rtpmap:32 MPV/90000
    m=video 0 RTP/AVP 66   
    a=rtpmap:66 H261/90000

	
]]></artwork>
        </figure>
		</section>		
	</section>
	
	
    <section title="IANA Considerations" toc="default">
		<t>
			This document requests IANA to register the new SDP Grouping semantic
			extension called BUNDLE.
		</t>
    </section>
		
    <section anchor="sec-acks" title="Acknowledgements" toc="default">
		<t>
			The usage of the SDP grouping extension for negotiating bundled media is 
			based on a similar alternatives proposed by Harald Alvestrand and Cullen
			Jennings. The BUNDLE extension described in this document is based on
			the different alternative proposals, and text (e.g. SDP examples)
			have been borrowed (and, in some cases, modified) from those alternative
			proposals.
		</t>
		<t>
			The SDP examples are also modified versions from the ones in the Alvestrand 
			proposal.
		</t>
		<t>
			Thanks to Paul Kyzivat, Martin Thomson and Flemming Andreasen for 
			taking the time to read the text along the way, and providing useful 
			feedback.
		</t>
    </section>

    <section title="Change Log">
		<t>[RFC EDITOR NOTE: Please remove this section when publishing]</t>
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-10
			<list style="symbols">
				<t>SDP bundle-only attribute added to IANA Considerations.</t>
				<t>SDES item and RTP header extension added to Abstract and Introduction.</t>
				<t>Modification to text updating section 8.2 of RFC 3264.</t>
				<t>Reference corrections.</t>
				<t>Editorial corrections.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-09
			<list style="symbols">
				<t>Terminology change: "bundle-only attribute assigned to m= line" to 
				"bundle-only attribute associated with m= line".</t>
				<t>Editorial corrections.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-08
			<list style="symbols">
				<t>Editorial corrections.</t>
				<t>- "of"->"if" (8.3.2.5).</t>
				<t>- "optional"->"OPTIONAL" (9.1).</t>
				<t>- Syntax/ABNF for 'bundle-only' attribute added.</t>
				<t>- SDP Offer/Answer sections merged.</t>
				<t>- 'Request new offerer BUNDLE address' section added</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-07
			<list style="symbols">
				<t>OPEN ISSUE regarding Receiver-ID closed.</t>
				<t>- RTP MID SDES Item.</t>
				<t>- RTP MID Header Extension.</t>
				<t>OPEN ISSUE regarding insertion of SDP 'rtcp' attribute in answers closed.</t>
				<t>- Indicating that, when rtcp-mux is used, the answerer MUST NOT include 
				an 'rtcp' attribute in the answer, based on the procedures in section 5.1.3 of 
				RFC 5761.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-06
			<list style="symbols">
				<t>Draft title changed.</t>
				<t>Added "SDP" to section names containing "Offer" or "Answer".</t>
				<t>Editorial fixes based on comments from Paul Kyzivat (http://www.ietf.org/mail-archive/web/mmusic/current/msg13314.html).</t>
				<t>Editorial fixed based on comments from Colin Perkins (http://www.ietf.org/mail-archive/web/mmusic/current/msg13318.html).</t>
				<t>- Removed text about extending BUNDLE to allow multiple RTP sessions within a BUNDLE group.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-05
			<list style="symbols">
				<t>Major re-structure of SDP Offer/Answer sections, to align with RFC 3264 structure.</t>
				<t>Additional definitions added.</t>
				<t>- Shared address.</t>
				<t>- Bundled "m=" line.</t>
				<t>- Bundle-only "m=" line.</t>
				<t>- Offerer suggested BUNDLE mid.</t>
				<t>- Answerer selected BUNDLE mid.</t>
				<t>Q6 Closed (IETF#88): An Offerer MUST NOT assign a shared address to multiple "m=" lines until it has 
				received an SDP Answer indicating support of the BUNDLE extension.</t>
				<t>Q8 Closed (IETF#88): An Offerer can, before it knows whether the Answerer supports the BUNDLE extension, 
				assign a zero port value to a 'bundle-only' "m=" line.</t>
				<t>SDP 'bundle-only' attribute section added.</t>
				<t>Connection data nettype/addrtype restrictions added.</t>
				<t>RFC 3264 update section added.</t>
				<t>Indicating that a specific payload type value can be used in multiple "m=" lines, if the value 
				represents the same codec configuration in each "m=" line.</t>					
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-04
			<list style="symbols">
				<t>Updated Offerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12293.html).</t>
				<t>Updated Answerer procedures (http://www.ietf.org/mail-archive/web/mmusic/current/msg12333.html).</t>
				<t>Usage of SDP 'bundle-only' attribute added.</t>
				<t>Reference to Trickle ICE document added.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-02
			<list style="symbols">
				<t>Mechanism modified, to be based on usage of SDP Offers 
				with both different and identical port number values, depending
				on whether it is known if the remote endpoint supports the
				extension.</t>
				<t>Cullen Jennings added as co-author.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-01
			<list style="symbols">
				<t>No changes. New version due to expiration.</t>
			</list>
		</t>		
		<t>Changes from draft-ietf-mmusic-sdp-bundle-negotiation-00
			<list style="symbols">
				<t>No changes. New version due to expiration.</t>
			</list>
		</t>		
		<t>Changes from draft-holmberg-mmusic-sdp-multiplex-negotiation-00
			<list style="symbols">
				<t>Draft name changed.</t>
				<t>Harald Alvestrand added as co-author.</t>
				<t>"Multiplex" terminology changed to "bundle".</t>				
				<t>Added text about single versus multiple RTP Sessions.</t>
				<t>Added reference to RFC 3550.</t>
			</list>
		</t>
    </section>
</middle>

<back>
    <references title="Normative References">
		<?rfc include="reference.RFC.2119"?>		
		<?rfc include="reference.RFC.3264"?>
		<?rfc include="reference.RFC.4566"?>
		<?rfc include="reference.RFC.5234"?>
		<?rfc include="reference.RFC.5285"?>
		<?rfc include="reference.RFC.5761"?>
		<?rfc include="reference.RFC.5888"?>
		<reference anchor="I-D.mmusic-sdp-mux-attributes">
            <front>
                <title abbrev="SDP Attribute Multiplexing">
					A Framework for SDP Attributes when Multiplexing
				</title>
                <author fullname="Suhas Nandakumar" initials="S.N" surname="Nandakumar">
                    <organization>Cisco</organization>
                    <address>
                    </address>
                    </author>
                <date day="3" month="July" year="2014" />
            </front>
            <seriesInfo name="Internet-Draft" value="draft-ietf-mmusic-sdp-mux-attributes-02" />
        </reference>
    </references>

    <references title="Informative References">				
		<?rfc include="reference.RFC.3550"?>
		<?rfc include="reference.RFC.3605"?>
		<?rfc include="reference.RFC.5245"?>		
		<?rfc include="reference.RFC.5576"?>
		<?rfc include="reference.RFC.5764"?>	
		<reference anchor="I-D.ietf-mmusic-trickle-ice">
            <front>
                <title abbrev="Trickle ICE">
					Trickle ICE: Incremental Provisioning of Candidates 
					for the Interactive Connectivity Establishment (ICE) Protocol
				</title>
                <author fullname="Emil Ivov" initials="E.I" surname="Ivov">
                    <organization>Jitsi</organization>
                </author>
                <author fullname="Eric Rescorla" initials="E.R" surname="Rescorla">
					<organization>RTFM, Inc</organization>
                </author>
                <author fullname="Justin Uberti" initials="J.U" surname="Uberti">
					<organization>Google</organization>
                </author>				
                <date day="7" month="February" year="2014" />
            </front>
            <seriesInfo name="Internet-Draft" value="draft-ietf-mmusic-trickle-ice-01" />
        </reference>		
    </references>
	
	<section  title="Design Considerations" toc="default">
		<section  title="General" toc="default">
			<t> 
				One of the main issues regarding the BUNDLE grouping extensions has been whether,
				in SDP Offers and SDP Answers, the same port number value should be inserted in "m=" 
				lines associated with a BUNDLE group, as the purpose of the extension is to negotiate
				the usage of a single 5-tuple for media associated with the "m=" lines. Issues
				with both approaches, discussed in the Appendix have been raised. The outcome was
				to specify a mechanism which uses SDP Offers with both different and identical
				port number values.
			</t>
			<t> 
				Below are the primary issues that have been considered when defining the "BUNDLE"
				grouping extension:
				<list style="symbols">
					<t>1) Interoperability with existing UAs.</t>
					<t>2) Interoperability with intermediary B2BUA- and proxy entities.</t>
					<t>3) Time to gather, and the number of, ICE candidates.</t>
					<t>4) Different error scenarios, and when they occur.</t>
					<t>5) SDP Offer/Answer impacts, including usage of port number value zero.</t>
				</list>
			</t>	
			<t>
				NOTE: Before this document is published as an RFC, this Appendix might be removed.
			</t>
		</section>

		<section  title="UA Interoperability" toc="default">
			<t> 
				Consider the following SDP Offer/Answer exchange, where Alice sends an SDP Offer to Bob:
			</t> 
			<figure>
				<artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer 

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10002 RTP/AVP 97
    a=rtpmap:97 H261/90000


]]></artwork>
			</figure>
			<figure>
				<artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[		 

SDP Answer 

    v=0
    o=bob 2808844564 2808844564 IN IP4 biloxi.example.com
    s=
    c=IN IP4 biloxi.example.com
    t=0 0
    m=audio 20000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 20002 RTP/AVP 97
    a=rtpmap:97 H261/90000

]]></artwork>
			</figure>
			<t> 
				RFC 4961 specifies a way of doing symmetric RTP but that is an a later
				invention to RTP and Bob can not assume that Alice supports RFC 4961. This
				means that Alice may be sending RTP from a different port than 10000 or
				10002 - some implementation simply send the RTP from an ephemeral
				port. When Bob's endpoint receives an RTP packet, the only way that Bob
				know if it should be passed to the video or audio codec is by looking at
				the port it was received on. This lead some SDP implementations to use the
				fact that each "m=" line had a different port number to use that port
				number as an index to find the correct m line in the SDP. As a result, some
				implementations that do support symmetric RTP and ICE still use a SDP data
				structure where SDP with "m=" lines with the same port such as:
			</t>
			<figure>
				<artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer 

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 10000 RTP/AVP 97
    a=rtpmap:97 iLBC/8000
    m=video 10000 RTP/AVP 98
    a=rtpmap:98 H261/90000


]]></artwork>
			</figure>
			<t> 
				will result in the second "m=" line being considered an SDP error
				because it has the same port as the first line.
			</t>
		</section>
		
		<section  title="Usage of port number value zero" toc="default">
			<t>
				In an SDP Offer or SDP Answer, the media associated with an "m=" line can be 
				disabled/rejected by setting the port number value to zero. This is different 
				from e.g. using the SDP direction attributes, where RTCP traffic will 
				continue even if the SDP "inactive" attribute is indicated for the 
				associated "m=" line.
			</t>
			<t>
				If each "m=" line associated with a BUNDLE group would contain different
				port number values, and one of those port would be used for the 5-tuple,
				problems would occur if an endpoint wants to disable/reject the "m=" line
				associated with that port, by setting the port number value to zero. After that,
				no "m=" line would contain the port number value which is used for the 5-tuple.				
				In addition, it is unclear what would happen to the ICE candidates associated 
				with the "m=" line, as they are also used for the 5-tuple.
			</t>
		</section>		

		<section  title="B2BUA And Proxy Interoperability" toc="default">
			<t>
				Some back to back user agents may be configured in a mode where if
				the incoming call leg contains an SDP attribute the B2BUA does not
				understand, the B2BUS still generates that SDP attribute in the Offer
				for the outgoing call leg. Consider an B2BUA that did not understand
				the SDP "rtcp" attribute, defined in RFC 3605, yet acted this way. 
				Further assume that the B2BUA was configured to tear down any call 
				where it did not see any RTCP for 5 minutes. In this cases, if the B2BUA 
				received an Offer like:
		</t>
		<figure>
			<artwork align="left" alt="" height="" name="" type="" width=""
                   xml:space="preserve"><![CDATA[

SDP Offer 

    v=0
    o=alice 2890844526 2890844526 IN IP4 atlanta.example.com
    s=
    c=IN IP4 atlanta.example.com
    t=0 0
    m=audio 49170 RTP/AVP 0
    a=rtcp:53020


]]></artwork>
        </figure>
        <t> 
			It would be looking for RTCP on port 49172 but would not see any
			because the RTCP would be on port 53020 and after five minutes, it would
			tear down the call. Similarly, an SBC that did not understand BUNDLE yet
			put BUNDLE in it's offer may be looking for media on the wrong port and
			tear down the call. It is worth noting that a B2BUA that generated an
			Offer with capabilities it does not understand is not compliant with the
			specifications. 
		</t>
		
			<section  title="Traffic Policing" toc="default">
				<t> 
					Sometimes intermediaries do not act as B2BUA, in the sense that
					they don't modify SDP bodies, nor do they terminate SIP dialogs.
					Still, however, they may use SDP information (e.g. IP address and 
					port) in order to control traffic gating functions, and to set
					traffic policing rules. There might be rules which will trigger
					a session to be terminated in case media is not sent or received
					on the ports retrieved from the SDP. This typically occurs once the
					session is already established and ongoing.
				</t>
			</section>
			<section  title="Bandwidth Allocation" toc="default">
				<t> 
					Sometimes intermediaries do not act as B2BUA, in the sense that
					they don't modify SDP bodies, nor do they terminate SIP dialogs.
					Still, however, they may use SDP information (e.g. codecs and 
					media types) in order to control bandwidth allocation functions. 
					The bandwidth allocation is done per "m=" line, which means that
					it might not be enough if media associated with all "m=" lines
					try to use that bandwidth. That may either simply lead to bad
					user experience, or to termination of the call.
				</t>
			</section>
		</section>

		<section  title="Candidate Gathering" toc="default">
			<t> 
				When using ICE, an candidate needs to be gathered for each port. This
				takes approximately 20 ms extra for each extra "m=" line due to the NAT
				pacing requirements. All of this gather can be overlapped with other
				things while the page is loading to minimize the impact. If the client
				only wants to generate TURN or STUN ICE candidates for one of the "m="
				lines and then use trickle ICE <xref target="I-D.ietf-mmusic-trickle-ice" /> 
				to get the non host ICE candidates for the rest of the "m=" lines, it MAY do 
				that and will not need any additional gathering time.
			</t>
			<t> 
				Some people have suggested a TURN extension to get a bunch of TURN
				allocation at once. This would only provide a single STUN result so in
				cases where the other end did not support BUNDLE, may cause more use of
				the TURN server but would be quick in the cases where both sides
				supported BUNDLE and would fall back to a successful call in the other
				cases.
			</t>
		</section>
    </section>
  </back>
</rfc>
